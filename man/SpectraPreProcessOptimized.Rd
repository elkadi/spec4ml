% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SpectraPreProcess2.R, R/SpectraPreProcess3.R,
%   R/SpectraPreProcess4.R
\name{SpectraPreProcessOptimized}
\alias{SpectraPreProcessOptimized}
\title{SpectraPreProcess2}
\usage{
SpectraPreProcessOptimized(
  rawspectra,
  maxSmWin = 11,
  derivWins1 = NULL,
  derivWins2 = NULL,
  extraDerivSmWins = c(15, 17)
)

SpectraPreProcessOptimized(
  rawspectra,
  maxSmWin = 11,
  derivWins1 = NULL,
  derivWins2 = NULL,
  extraDerivSmWins = c(15, 17)
)

SpectraPreProcessOptimized(
  rawspectra,
  maxSmWin = 11,
  derivWins1 = NULL,
  derivWins2 = NULL,
  extraDerivSmWins = c(15, 17)
)
}
\arguments{
\item{rawspectra}{A `hyperSpec` object containing the raw spectra to preprocess.}

\item{maxSmWin}{Integer.  The largest Savitzky–Golay window length (must be odd) to be used for
smoothing.  All odd window lengths from 3 up to this value will be applied.  Defaults to 11
to match the original function.  If the provided value is even it will be reduced by one.}

\item{derivWins1}{Integer vector.  First derivative SG window lengths.  Defaults to c(3, 9).
Odd numbers larger than two should be supplied.  Additional values may be supplied via
`extraDerivSmWins`.}

\item{derivWins2}{Integer vector.  Second derivative SG window lengths.  Defaults to c(3, 11).
Odd numbers larger than two should be supplied.  Additional values may be supplied via
`extraDerivSmWins`.}

\item{extraDerivSmWins}{Integer vector.  Additional SG window lengths to apply to both first
and second derivatives.  Defaults to c(15, 17) to mirror the optional derivative smoothing
present in the original code【955124169944246†L44-L48】.}
}
\value{
A list containing two elements: (1) a named list of processed `hyperSpec` objects and
  (2) a character vector of the corresponding names.  The output names reflect the processing
  steps applied, for example `Sm5` (smoothed with window 5) or `Sm7blUvn` (window 7 smoothed,
  baseline corrected and UV normalised).

A list containing two elements: (1) a named list of processed `hyperSpec` objects and
  (2) a character vector of the corresponding names.  The output names reflect the processing
  steps applied, for example `Sm5` (smoothed with window 5) or `Sm7blUvn` (window 7 smoothed,
  baseline corrected and UV normalised).

A list containing two elements: (1) a named list of processed `hyperSpec` objects and
  (2) a character vector of the corresponding names.  The output names reflect the processing
  steps applied, for example `Sm5` (smoothed with window 5) or `Sm7blUvn` (window 7 smoothed,
  baseline corrected and UV normalised).
}
\description{
Preprocess a hyperspectral dataset using a flexible set of Savitzky–Golay (SG) smoothing windows
and a streamlined pipeline for common spectral corrections.  In contrast to the original
implementation provided in `spec4ml`, this version removes a large amount of code duplication
and exposes parameters that allow the user to process spectra with every odd‑sized SG window up
to a user specified maximum.  Additional derivatives and normalisation steps are still
supported via arguments but can easily be tailored for bespoke workflows. Optimized done by ChatGPT agent
as instrucred by the original author "Omar Anwar Elkadi"

Preprocess a hyperspectral dataset using a flexible set of Savitzky–Golay (SG) smoothing windows
and a streamlined pipeline for common spectral corrections.  In contrast to the original
implementation provided in `spec4ml`, this version removes a large amount of code duplication
and exposes parameters that allow the user to process spectra with every odd‑sized SG window up
to a user specified maximum.  Additional derivatives and normalisation steps are still
supported via arguments but can easily be tailored for bespoke workflows.

Preprocess a hyperspectral dataset using a flexible set of Savitzky–Golay (SG) smoothing windows
and a streamlined pipeline for common spectral corrections.  In contrast to the original
implementation provided in `spec4ml`, this version removes a large amount of code duplication
and exposes parameters that allow the user to process spectra with every odd‑sized SG window up
to a user specified maximum.  Additional derivatives and normalisation steps are still
supported via arguments but can easily be tailored for bespoke workflows.
 In addition to smoothing, derivatives, SNV, baseline and UV normalisation,
 this version now also applies Multiplicative Scatter Correction (MSC) using
 `prospectr::msc` and Extended Multiplicative Signal Correction (EMSC) using
 `EMSC::EMSC`.  MSC removes additive and multiplicative scattering effects by
 aligning each spectrum to a reference【189035542347124†screenshot】, while EMSC
 performs model-based correction for scaling, polynomial baselines and
 interferents【729034731224589†L19-L33】.
}
